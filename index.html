<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>×¡×•×¤×¨ ×¡×˜××¨ - ×”×›×™ ×˜×¨×™ ×©×™×©</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <style>
        :root {
            --main-blue: #0047ba;
            --main-yellow: #ffcc00;
            --light-bg: #f8f9fa;
        }

        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; background: var(--light-bg); color: #333; overflow-x: hidden; }
        
        header { background: var(--main-blue); color: white; padding: 20px; border-bottom: 5px solid var(--main-yellow); position: sticky; top: 0; z-index: 1000; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        
        /* ××–×•×¨ ×”××‘×¦×¢×™× - ×’×œ×™×œ×” ×¨×¦×™×¤×” ×œ×œ× ×”×¤×¡×§×” */
        .promo-section { 
            width: 100%;
            background: white;
            margin: 20px 0;
            padding: 10px 0;
            overflow: hidden; /* ××¡×ª×™×¨ ××ª ××” ×©×™×•×¦× ××”××¡×š */
            white-space: nowrap;
            position: relative;
        }

        .promo-track {
            display: inline-flex;
            animation: scroll-left 80s linear infinite; /* ×ª× ×•×¢×” ×¨×¦×™×¤×” */
        }

        /* ×× ×™×¢×ª ×¨×•×•×—×™× ×‘×™×Ÿ ×ª××•× ×•×ª ××©×•×›×¤×œ×•×ª */
        .promo-track img {
            height: 400px; /* ×’×•×‘×” ×§×‘×•×¢ ×©×××¤×©×¨ ×œ×¨××•×ª ××ª ×›×œ ×”×ª××•× ×” */
            width: auto;   /* ×¨×•×—×‘ ××©×ª× ×” ×œ×¤×™ ×”×ª××•× ×” ×”××§×•×¨×™×ª */
            display: block;
            margin-right: 0;
            border-radius: 0px;
            margin: 0 5px; /* ×¨×•×•×— ×§×˜×Ÿ ×•× ×¢×™× ×‘×™×Ÿ ×ª××•× ×•×ª */
        }

        /* ×× ×™××¦×™×™×ª ×”×’×œ×™×œ×” */
        @keyframes scroll-left {
            0% { transform: translateX(0); }
            100% { transform: translateX(50%); } /* ×–×– ×—×¦×™ ×“×¨×š ×›×™ ×× ×—× ×• ××©×›×¤×œ×™× ××ª ×”×ª×•×›×Ÿ */
        }

        /* ×¢×¦×™×¨×ª ×”×× ×™××¦×™×” ×›×©× ×•×’×¢×™× ×¢× ×”×¢×›×‘×¨ */
        .promo-section:hover .promo-track {
            animation-play-state: paused;
        }

        .container { max-width: 1100px; margin: 0 auto; padding: 20px; }
        .category-title { border-right: 5px solid var(--main-blue); padding-right: 15px; margin: 30px 0 20px; text-align: right; color: var(--main-blue); }
        
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 15px; }
        
        .card { background: white; border-radius: 12px; padding: 15px; text-align: center; transition: transform 0.2s; border: 1px solid #eee; position: relative; overflow: hidden; }
        .card:hover { transform: translateY(-5px); box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .card img { width: 100%; height: 140px; object-fit: contain; margin-bottom: 10px; }
        .card h3 { font-size: 1.1rem; margin: 10px 0; height: 2.4em; overflow: hidden; }
        .card .price { color: #d32f2f; font-size: 1.4rem; font-weight: bold; }
        .card .barcode { font-size: 0.75rem; color: #888; margin-top: 10px; display: block; }

        .fab { position: fixed; bottom: 25px; left: 25px; z-index: 1001; display: flex; flex-direction: column; gap: 15px; }
        .btn-round { width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; text-decoration: none; box-shadow: 0 4px 12px rgba(0,0,0,0.2); transition: 0.3s; }
        .btn-whatsapp { background: #25d366; font-size: 30px; }
        .btn-waze { background: #33ccff; font-size: 20px; font-weight: bold; }

        @media (max-width: 600px) {
            .grid { grid-template-columns: repeat(2, 1fr); }
            .promo-track img { height: 250px; } /* ×’×•×‘×” ××•×ª×× ×œ× ×™×™×“ */
        }
    </style>
</head>
<body>

<header style="display: flex; align-items: center; justify-content: center; flex-direction: column;">
    <img src="https://res.cloudinary.com/dj56w7nb9/image/upload/f_auto,q_auto/logo.png" alt="×¡×•×¤×¨ ×¡×˜××¨" style="max-width: 150px; height: auto;">
    <div style="font-size: 1rem; margin-top: 10px; color: white;">×”××™×›×•×ª ×©×œ× ×•, ×”×—×™×•×š ×©×œ×›×</div>
</header>

<div class="promo-section" id="promo-area">
    <div class="promo-track" id="promo-container">
        </div>
</div>

<div class="container">
    <div id="categories-wrapper"></div>
</div>

<div class="fab">
    <a href="https://waze.com/ul/hsvc562y69" class="btn-round btn-waze" target="_blank">WAZE</a>
    <a href="https://wa.me/97249076772" class="btn-round btn-whatsapp" target="_blank">ğŸ’¬</a>
</div>

<script>
const CONFIG = {
    CLOUD_NAME: "dj56w7nb9", 
    CSV_URL: "https://docs.google.com/spreadsheets/d/e/2PACX-1vRQkkYTwMe4n3ViI8N474bKHGGNwqa0GTMwskoWEEOrWJeA-BUrCcK95FZHNqcNqxhlF2INxL9GO70z/pub?output=csv",
    PROMO_TAG: "promo"
};

function isPromoActive(folderName) {
    try {
        const [start, end] = folderName.split('-');
        const parse = (s) => {
            const [d, m, y] = s.split('.').map(Number);
            return new Date(2000 + y, m - 1, d);
        };
        const today = new Date();
        today.setHours(0,0,0,0);
        return today >= parse(start) && today <= parse(end);
    } catch(e) { return false; }
}

async function init() {
    // 1. ×˜×¢×™× ×ª ××‘×¦×¢×™×
    try {
        const res = await fetch(`https://res.cloudinary.com/${CONFIG.CLOUD_NAME}/image/list/${CONFIG.PROMO_TAG}.json`);
        if (res.ok) {
            const data = await res.json();
            const container = document.getElementById('promo-container');
            let imagesHtml = '';

            data.resources.forEach(img => {
                const parts = img.public_id.split('/');
                const folderName = parts[1]; 

                if (isPromoActive(folderName)) {
                    const imgUrl = `https://res.cloudinary.com/${CONFIG.CLOUD_NAME}/image/upload/f_auto,q_auto/${img.public_id}.${img.format}`;
                    imagesHtml += `<img src="${imgUrl}">`;
                }
            });

            if (imagesHtml !== '') {
                // ××©×›×¤×œ×™× ××ª ×”×ª××•× ×•×ª ×›×“×™ ×œ×™×¦×•×¨ ×¨×¦×£ ××™× ×¡×•×¤×™ ×œ×œ× "×§×¤×™×¦×”" ×‘×¡×•×£
                container.innerHTML = imagesHtml + imagesHtml;
            } else {
                document.getElementById('promo-area').style.display = 'none';
            }
        }
    } catch(e) { 
        console.error("×©×’×™××” ×‘×˜×¢×™× ×ª ××‘×¦×¢×™×:", e); 
        document.getElementById('promo-area').style.display = 'none';
    }

    // 2. ×˜×¢×™× ×ª ××•×¦×¨×™×
    Papa.parse(CONFIG.CSV_URL, {
        download: true, header: true, skipEmptyLines: true,
        complete: function(results) {
            const wrapper = document.getElementById('categories-wrapper');
            const cats = {};
            results.data.forEach(p => {
                if(!p.Category || !p.Barcode) return;
                if(!cats[p.Category]) cats[p.Category] = [];
                cats[p.Category].push(p);
            });

            for(let cat in cats) {
                let section = `<h2 class="category-title">${cat}</h2><div class="grid">`;
                cats[cat].forEach(p => {
                    const barcode = p.Barcode.trim();
                    const imgUrl = `https://res.cloudinary.com/${CONFIG.CLOUD_NAME}/image/upload/f_auto,q_auto/products/${barcode}`;
                    section += `<div class="card">
                        <img src="${imgUrl}" onerror="this.onerror=null; this.src='https://via.placeholder.com/150?text=××™×Ÿ+×ª××•× ×”'">
                        <h3>${p.Name}</h3>
                        <div class="price">â‚ª${p.Price}</div>
                        <span class="barcode">×‘×¨×§×•×“: ${barcode}</span>
                    </div>`;
                });
                section += `</div>`;
                wrapper.innerHTML += section;
            }
        }
    });
}

init();
</script>
</body>
</html>



